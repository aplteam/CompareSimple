 R←Test_036(stopFlag batchFlag);was;fk;name1;name2;fn1;fn2;repFile;buffer;⎕TRAP
⍝ Exercise the RunCompareItReport method
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')
 R←∆Failed

 ⍝ Preconditions
 ##.CompareSimple.pathToCompareIt←''
 fk←'HKCU\Software\APLTree\Compare\PathToCompareIt!'        ⍝ Full key
 was←#.WinReg.GetString fk
 #.WinReg.DeleteValue fk

 repFile←#.FilesAndDirs.GetTempFilename''
 name1←'#.Old.Dlgs.ErrMsg'
 fn1←#.FilesAndDirs.GetTempFilename''
 #.APLTreeUtils.WriteUtf8File fn1(⎕NR name1)
 name2←'#.New.Dlgs.ErrMsg'
 fn2←#.FilesAndDirs.GetTempFilename''
 #.APLTreeUtils.WriteUtf8File fn2(⎕NR name2)

 ##.CompareSimple.RunCompareItReport fn1 fn2 repFile
 buffer←#.APLTreeUtils.ReadUtf8File repFile
 →PassesIf 10<⍴buffer

⍝ Tidy up
 #.FilesAndDirs.DeleteFile repFile fn1 fn2

 R←∆OK
