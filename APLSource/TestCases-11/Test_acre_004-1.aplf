 R←Test_acre_004(stopFlag batchFlag);filename;parms;name1;name2;list;rc;⎕TRAP;body;path;tno;size1;size2;result
⍝ Exercise "These" with script name and an acre component file
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')
 R←∆Failed

 :If 1≢batchFlag
 :AndIf ∆AcreFlag
     ⎕←'   *** Make sure that the first file gets changed!'
     ⎕←'   When your are ready, press <enter>'
     {}⍞
     #.⎕EX'CompareTemporaryTestCases'
     'CompareTemporaryTestCases'#.⎕NS''
     path←∆RemoveTempProject
     result←⎕SE.UCMD'acre.CreateProject ',path,' #.CompareTemporaryTestCases'
     Assert~0∊⍴result
     #.CompareTemporaryTestCases.⎕FIX ⎕SRC #.New.APLTeamUtils
     name1←'#.CompareTemporaryTestCases.APLTeamUtils'
     result←⎕SE.UCMD'acre.setChanged #.CompareTemporaryTestCases.APLTeamUtils'
     Assert~0∊⍴result
     filename←∆Simplify ∆GetChangeFilename name1
     body←⎕SRC #.CompareTemporaryTestCases.APLTeamUtils
     body←body[1],(⊂'⍝⍝⍝⍝ NEW ADDED LINE'),1↓body
     #.CompareTemporaryTestCases.⎕FIX body
     result←⎕SE.UCMD'acre.setChanged #.CompareTemporaryTestCases.APLTeamUtils'
     Assert~0∊⍴result
     tno←filename ⎕FTIE 0
     size1←⎕FSIZE tno
     ⎕FUNTIE tno
     rc←##.CompareSimple.These⍎name1
     tno←filename ⎕FTIE 0
     size2←⎕FSIZE tno
     ⎕FUNTIE tno
     →GoToTidyUp~size1[2]<size2[3]
     R←∆OK

∆TidyUp:
     #.⎕EX'CompareTemporaryTestCases'
     ∆RemoveTempProject
 :Else
     R←∆Inactive
 :EndIf
